var $jscomp={scope:{},findInternal:function(b,d,f){b instanceof String&&(b=String(b));for(var g=b.length,a=0;a<g;a++){var c=b[a];if(d.call(f,c,a,b))return{i:a,v:c}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,d,f){if(f.get||f.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[d]=f.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,d,f,g){if(d){f=$jscomp.global;b=b.split(".");for(g=0;g<b.length-1;g++){var a=b[g];a in f||(f[a]={});f=f[a]}b=b[b.length-1];g=f[b];d=d(g);d!=g&&null!=d&&$jscomp.defineProperty(f,b,{configurable:!0,writable:!0,value:d})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,f){return $jscomp.findInternal(this,b,f).v}},"es6-impl","es3");
sysPass.Triggers=function(b){var d=b.log,f=function(a){var c={valueField:"id",labelField:"name",searchField:["name"]};a.find(".select-box").each(function(a){var d=$(this);c.plugins=d.hasClass("select-box-deselect")?{clear_selection:{title:b.config().LANG[51]}}:{};if(d.data("onchange")){var e=d.data("onchange").split("/");c.onChange=function(a){if(0<a)if(2===e.length)sysPassApp.actions()[e[0]][e[1]](d);else sysPassApp.actions()[e[0]](d)}}d.selectize(c)});a.find("#allowed_exts").selectize({create:function(a){return{value:a.toUpperCase(),
text:a.toUpperCase()}},createFilter:/^[a-z0-9]{1,4}$/i,plugins:["remove_button"]});a.find("#wikifilter").selectize({create:!0,createFilter:/^[a-z0-9:._-]+$/i,plugins:["remove_button"]});a.find(".select-items-tag").selectize({create:function(a){return{value:a.toLowerCase(),text:a.toLowerCase()}},createFilter:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/,plugins:["remove_button"]})},g={main:function(a){d.info("views:main");
clipboard.isSupported()||b.msg.info(b.config().LANG[65]);$(".btn-menu").click(function(){var a=$(this);"1"===a.attr("data-history-reset")&&b.appRequests().history.reset();b.appActions().doAction({r:a.data("route")},a.data("view"))});if(0===a.data("upgraded"))b.appActions().doAction({r:"account/index"},"search");else{a=$("#content");var c=a.data("page");g.common(a);if(""!==c&&"function"===typeof g[c])g[c]()}!0===b.config().CHECK_UPDATES&&b.appActions().main.getUpdates();!0===b.config().CHECK_NOTICES&&
b.appActions().main.getNotices();"function"===typeof b.appTheme().viewsTriggers.main&&b.appTheme().viewsTriggers.main()},search:function(){d.info("views:search");var a=$("#frmSearch");0!==a.length&&(a.find("input[name='search']").on("keyup",function(b){b.preventDefault();13!==b.which&&13!==b.keyCode||a.submit()}),a.find("select, #rpp").on("change",function(){a.submit()}),a.find("button.btn-clear").on("click",function(b){b.preventDefault();a.find('input[name="searchfav"]').val(0);a[0].reset()}),a.find("input:text:visible:first").focus(),
$("#globalSearch").click(function(){var b=1==$(this).prop("checked")?1:0;a.find("input[name='gsearch']").val(b);a.submit()}),"function"===typeof b.appTheme().viewsTriggers.search&&b.appTheme().viewsTriggers.search())},login:function(){d.info("views:login");var a=$("#frmLogin");b.config().AUTHBASIC_AUTOLOGIN&&"0"===a.find("input[name='loggedOut']").val()&&(d.info("views:login:autologin"),b.msg.info(b.config().LANG[66]),b.appActions().main.login(a))},userpassreset:function(){d.info("views:userpassreset");
var a=$("#frmUserPassReset");b.appTheme().passwordDetect(a)},footer:function(){d.info("views:footer")},common:function(a){d.info("views:common");f(a);var c=a.find(":input [name='sk']");0<c.length&&b.sk.set(c.val());"function"===typeof b.appTheme().viewsTriggers.common&&b.appTheme().viewsTriggers.common(a);b.appTriggers().updateFormHash(a)},datatabs:function(){d.info("views:datatabs");$(".datagrid-action-search>form").each(function(){var a=$(this);a.find("button.btn-clear").on("click",function(b){b.preventDefault();
a.trigger("reset")})})},config:function(){d.info("views:config");var a=$("#drop-import-files");if(0<a.length){var c=b.fileUpload(a);c.url=b.appActions().ajaxUrl.entrypoint+"?r="+a.data("action-route");c.allowedExts=b.config().IMPORT_ALLOWED_EXTS;c.beforeSendAction=function(){c.setRequestData({sk:b.sk.get(),csvDelimiter:$("#csvDelimiter").val(),importPwd:$("#importPwd").val(),importMasterPwd:$("#importMasterPwd").val(),import_defaultuser:$("#import_defaultuser").val(),import_defaultgroup:$("#import_defaultgroup").val()})}}},
account:function(){d.info("views:account");var a=$("#list-account-files");0<a.length&&b.appActions().account.listFiles(a);var c=$("#drop-account-files");if(0<c.length){var e=b.fileUpload(c);e.url=b.appActions().ajaxUrl.entrypoint+"?r="+c.data("action-route")+"/"+c.data("item-id");e.allowedExts=b.config().FILES_ALLOWED_EXTS;e.requestDoneAction=function(){b.appActions().account.listFiles(a)}}c=$("#parent_account_id");0<c.length&&(c.on("change",function(){var a=$(this),b=$("#accountpass,#accountpassR");
0<a[0].value?b.each(function(){$(this).prop("disabled","true");$(this).prop("required","false")}):b.each(function(){$(this).prop("disabled","");$(this).prop("required","true")})}),b.appActions().items.get(c));$(".select-box-tags").selectize({persist:!1,valueField:"id",labelField:"name",searchField:["name"],plugins:["remove_button"],onInitialize:function(){var a=this.$input[0],b=document.createAttribute("data-hash");b.value=SparkMD5.hash(this.getValue().join(),!1);a.setAttributeNode(b);"undefined"!==
typeof a.dataset.currentItemId&&this.removeOption(a.dataset.currentItemId,!0)},onChange:function(){var a=this.$input[0],b=document.createAttribute("data-updated");b.value=SparkMD5.hash(this.getValue().join(),!1)!==a.dataset.hash&&"true";a.setAttributeNode(b)}});$("input:text:visible:first").focus()},install:function(){d.info("views:install");var a=$("#frmInstall");b.appTheme().passwordDetect(a);f(a)}};return{views:g,selectDetect:f,updateSk:function(){$("#content").find("[data-sk]").each(function(){d.info("updateSk");
$(this).data("sk",b.sk.get())})},updateFormHash:function(a){d.info("updateFormHash");a=void 0!==a?a.find(".form-action[data-hash]"):$(".form-action[data-hash]");0<a.length&&a.each(function(){var a=$(this);a.attr("data-hash",SparkMD5.hash(a.serialize(),!1))})},bodyHooks:function(){d.info("bodyHooks");$("body").on("click","button.btn-action[data-onclick][type='button'],li.btn-action[data-onclick],span.btn-action[data-onclick],i.btn-action[data-onclick],a.btn-action[data-onclick],.btn-action-pager[data-onclick]",
function(){var a=$(this);d.info("handleActionButton: "+a.attr("id"));var c=a.data("onclick").split("/"),e;e=a.data("plugin");e=void 0!==e&&void 0!==b.appPlugins()[e]?b.appPlugins()[e]:b.appActions();if(2===c.length)e[c[0]][c[1]](a);else e[c[0]](a)}).on("click",".btn-back",function(){var a=b.appRequests();if(0<a.history.length()){d.info("back");var c=a.history.del();a.getActionCall(c,c.callback)}}).on("submit",".form-action",function(a){a.preventDefault();a=$(this);d.info("formAction");var c=a.attr("data-hash"),
e=SparkMD5.hash(a.serialize(),!1);if(c===e)b.msg.ok(b.config().LANG[55]);else if(c=a.data("plugin"),c=void 0!==c&&void 0!==b.appPlugins()[c]?b.appPlugins()[c]:b.appActions(),e=a.data("onsubmit").split("/"),a.find("input[name='sk']").val(b.sk.get()),2===e.length)c[e[0]][e[1]](a);else c[e[0]](a)}).on("click",".btn-help[data-help]",function(){var a=$(this),a=$.find("div[for='"+a.data("help")+"']");if(0<a.length){var c=b.config().LANG[54]+" - "+a[0].getAttribute("title")||b.config().LANG[54];mdlDialog().show({title:c,
text:a[0].innerHTML,positive:{title:b.config().LANG[43]}})}}).on("reset",".form-action",function(a){a.preventDefault();d.info("reset");a=$(this);a.find("input:text, input:password, input:file, textarea").val("").parent("div").removeClass("is-dirty");a.find("input:radio, input:checkbox").prop("checked",!1).prop("selected",!1);a.find("input[name='start'], input[name='skey'], input[name='sorder']").val(0);a.find("select").each(function(){$(this)[0].selectize.clear(!0)});a.submit()}).on("click",".btn-popup-close",
function(a){$.magnificPopup.close()})}}};
